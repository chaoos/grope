!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.grope=e()}}(function(){var e;return function e(t,o,n){function i(r,p){if(!o[r]){if(!t[r]){var a="function"==typeof require&&require;if(!p&&a)return a(r,!0);if(s)return s(r,!0);var h=new Error("Cannot find module '"+r+"'");throw h.code="MODULE_NOT_FOUND",h}var l=o[r]={exports:{}};t[r][0].call(l.exports,function(e){var o=t[r][1][e];return i(o?o:e)},l,l.exports,e,t,o,n)}return o[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)i(n[r]);return i}({1:[function(t,o,n){!function(i){if("object"==typeof o&&"object"==typeof o.exports){var s=i(t,n);void 0!==s&&(o.exports=s)}else"function"==typeof e&&e.amd&&e(["require","exports"],i)}(function(e,t){"use strict";function o(e,t){void 0===t&&(t={});var o=e instanceof Array?e:new Array(e);Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),o=this,n=function(){},i=function(){return o.apply(this instanceof n?this:e,t.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(n.prototype=this.prototype),i.prototype=new n,i});var n={onload:1,onunload:1,onblur:1,onchange:1,onfocus:1,onreset:1,onselect:1,onsubmit:1,onabort:1,onkeydown:1,onkeypress:1,onkeyup:1,onclick:1,ondblclick:1,onmousedown:1,onmousemove:1,onmouseout:1,onmouseover:1,onmouseup:1},i={onscroll:window},s=function(){function e(e,t){this.containers=e,this.options=t,this.gropeElement=null,this.gropeClone=null,this.gropeContainer=null,this.originGropeContainer=null,this.copyElement=null,this.mapping=[],this.originMapping=[],this.rectCache=[],this.classGropable="gr-gropable",this.classTossZone="gr-tosszone",this.classGroping="gr-groping",this.classModeGroping="gr-mode-groping",this.classMove="move",this.classCopy="copy",this.classDisappear="gr-disappear",this.mouseDownHandlers=[],this.customEvents=[],this.containers=e,this.options={elements:["div"],tossCallback:function(){return!0},copy:!1};for(var o in t)if(t.hasOwnProperty(o))if("object"==typeof t[o])for(var n in t[o])t[o].hasOwnProperty(n)&&(this.options[o][n]=t[o][n]);else this.options[o]=t[o];this.init()}return e.prototype.init=function(){var e=this;for(var t in this.containers){var o=this.containers[t];this.addClass(o,this.classTossZone);var n=0;this.mapping[t]=[];for(var i=0,s=o.querySelectorAll(this.options.elements.join(", "));i<s.length;i++){var r=s[i];this.addClass(r,this.classGropable),this.addClass(r,this.options.copy?this.classCopy:this.classMove),this.mapping[t][n]=r;var p=function(t){return e.mouseDown(t)};this.addEventListener(r,"mousedown",p),n++}}},e.prototype.reinit=function(){},e.prototype.remap=function(){this.mapping=[],this.rectCache=[];for(var e in this.containers){this.mapping[e]=[];for(var t=0,o=0,n=this.containers[e].querySelectorAll(this.options.elements.join(", "));o<n.length;o++){var i=n[o];i!==this.gropeClone&&(this.mapping[e][t]=i,t++)}}return this.mapping},e.prototype.mouseDown=function(e){var t=this;if(this.originMapping=this.remap(),this.gropeElement=this.getElementBehindCursor(e.clientX,e.clientY),this.gropeContainer=this.getContainerByGropeElement(this.gropeElement),this.originGropeContainer=this.gropeContainer,null!=this.gropeContainer){if(this.options.copy===!0){this.copyElement=this.gropeElement,this.gropeElement=this.gropeElement.cloneNode(!0),this.gropeContainer.insertBefore(this.gropeElement,this.copyElement);var o=function(e){return t.mouseDown(e)};this.addEventListener(this.gropeElement,"mousedown",o),this.remap()}this.gropeClone=this.gropeElement.cloneNode(!0),this.gropeClone.style.width=this.gropeElement.offsetWidth+"px",this.gropeClone.style.height=this.gropeElement.offsetHeight+"px",this.addClass(this.gropeClone,this.classGroping),this.addClass(this.gropeElement,this.classDisappear),this.addClass(document.body,this.classModeGroping),this.addClass(document.body,this.options.copy?this.classCopy:this.classMove);var n=this.getRect(this.gropeElement,!0);this.deltaX=e.clientX-n.left,this.deltaY=e.clientY-n.top,this.mouseMove(e),this.gropeContainer.appendChild(this.gropeClone),this.mouseMoveHandler=function(e){return t.mouseMove(e)},this.addEventListener(document.documentElement,"mousemove",this.mouseMoveHandler),this.mouseUpHandler=function(e){return t.mouseUp(e)},this.addEventListener(document.documentElement,"mouseup",this.mouseUpHandler)}},e.prototype.mouseUp=function(e){this.removeEventListener(document.documentElement,"mousemove",this.mouseMoveHandler),this.removeEventListener(document.documentElement,"mouseup",this.mouseUpHandler),this.removeClass(this.gropeElement,this.classDisappear),this.removeClass(document.body,this.classModeGroping),this.removeClass(document.body,this.classCopy),this.removeClass(document.body,this.classMove),this.gropeClone.parentNode.removeChild(this.gropeClone);for(var t=0,o=this.containers;t<o.length;t++){var n=o[t];this.removeClass(n,"active")}this.options.tossCallback(this.gropeElement,this.originGropeContainer,this.gropeContainer)===!1&&this.revertChanges(),this.gropeElement=null,this.gropeClone=null,this.gropeContainer=null,this.copyElement=null},e.prototype.mouseMove=function(e){if("which"in e&&0==e.which||"undefined"==typeof e.which&&"button"in e&&0==e.button)return void this.mouseUp(e);var t,o=e.clientX,n=e.clientY;this.gropeClone.style.left=o-this.deltaX+"px",this.gropeClone.style.top=n-this.deltaY+"px";var i=!1;for(var s in this.mapping)for(var r=0,p=this.mapping[s];r<p.length;r++){var a=p[r],h=this.getRect(a);if(i===!1&&o>=h.left&&o<=a.offsetWidth+h.left&&n>=h.top&&n<=a.offsetHeight+h.top&&(i=!0,t=this.getContainerByGropeElement(a),this.addClass(t,"active"),a!=this.gropeElement)){var l=this.gropeElement.compareDocumentPosition(a);l==Node.DOCUMENT_POSITION_PRECEDING?(t.insertBefore(this.gropeElement,a),this.gropeContainer=t,this.remap()):l==Node.DOCUMENT_POSITION_FOLLOWING&&(t.insertBefore(this.gropeElement,a.nextSibling),this.gropeContainer=t,this.remap())}}if(i===!1)for(var c=0,u=this.containers;c<u.length;c++){t=u[c];var h=this.getRect(t);i===!1&&o>=h.left&&o<=t.offsetWidth+h.left&&n>=h.top&&n<=t.offsetHeight+h.top?(i=!0,this.addClass(t,"active"),t!=this.gropeContainer&&(t.appendChild(this.gropeElement),t.appendChild(this.gropeClone),this.gropeContainer=t,this.remap())):this.removeClass(t,"active")}},e.prototype.revertChanges=function(){this.revertCopy()},e.prototype.revertMove=function(){for(var e in this.originMapping)for(var t in this.originMapping[e])if(this.originMapping[e][t]==this.gropeElement){this.getContainerByGropeElement(this.gropeElement).removeChild(this.gropeElement);var o=this.originGropeContainer.querySelectorAll(this.options.elements.join(", "));return void this.originGropeContainer.insertBefore(this.gropeElement,o[t])}},e.prototype.revertCopy=function(){null!==this.copyElement&&(this.getContainerByGropeElement(this.gropeElement).removeChild(this.gropeElement),this.gropeElement=this.copyElement,this.copyElement=null),this.revertMove()},e.prototype.getRect=function(e,t){if(void 0===t&&(t=!1),t===!1)for(var o=0,n=this.rectCache;o<n.length;o++){var i=n[o];if(i.object==e)return i.rect}var s=e.getBoundingClientRect();return this.rectCache.push({object:e,rect:s}),s},e.prototype.copyComputedStyle=function(e,t){var o=!1;if(o=e.currentStyle||document.defaultView.getComputedStyle(e,null),!o)return null;for(var n=0,i=o;n<i.length;n++){var s=i[n],r=o[s];"undefined"!=typeof r&&"object"!=typeof r&&"function"!=typeof r&&r.length>0&&r!=parseInt(r)&&(t.style[s]=r)}},e.prototype.addClass=function(e,t){this.hasClass(e,t)||(e.className+=" "+t+" ")},e.prototype.removeClass=function(e,t){var o=new RegExp(" "+t+" ","g");e.className=e.className.replace(o,"")},e.prototype.hasClass=function(e,t){var o=new RegExp(" "+t+" ");return null!==e.className.match(o)},e.prototype.getContainerByGropeElement=function(e){for(var t in this.mapping)for(var o=0,n=this.mapping[t];o<n.length;o++){var i=n[o];if(i==e)return this.containers[t]}return null},e.prototype.getElementBehindCursor=function(e,t){for(var o=document.elementFromPoint(e,t);o&&!this.hasClass(o,this.classGropable);)o=o.parentElement;return o},e.prototype.addEventListener=function(e,t,o,s){void 0===s&&(s=!0);var r=s?o.bind(this):o;if("function"==typeof e.addEventListener)i["on"+t]&&"BODY"==e.tagName&&(e=i["on"+t]),e.addEventListener(t,r);else if("object"==typeof e.attachEvent&&n["on"+t])e.attachEvent("on"+t,r);else if("object"==typeof e.attachEvent&&i["on"+t])if("BODY"==e.tagName){var p="on"+t;i[p][p]=r}else e.onscroll=r;else"object"==typeof e.attachEvent?(e[t]=1,r=function(e){e.propertyName==t&&o(e)},e.attachEvent("onpropertychange",r)):e["on"+t]=r;this.customEvents[t]?null:this.customEvents[t]=[],this.customEvents[t].push([o,r])},e.prototype.removeEventListener=function(e,t,o){if(t in this.customEvents)for(var i in this.customEvents[t])if(this.customEvents[t][i][0]==o){o=this.customEvents[t][i][1],this.customEvents[t].splice(i,1);break}"function"==typeof e.removeEventListener?e.removeEventListener(t,o):"object"==typeof e.detachEvent&&n["on"+t]?e.detachEvent("on"+t,o):"object"==typeof e.detachEvent?e.detachEvent("onpropertychange",o):e["on"+t]=null},e.prototype.triggerEvent=function(e,t){var o;"function"==typeof window.CustomEvent?o=new CustomEvent(t):"function"==typeof document.createEvent?(o=document.createEvent("HTMLEvents"),o.initEvent(t,!0,!0)):document.createEventObject&&(o=document.createEventObject(),o.eventType=t),o.eventName=t,e.dispatchEvent?e.dispatchEvent(o):e[t]?e[t]++:e.fireEvent&&n["on"+t]?e.fireEvent("on"+o.eventType,o):e[t]?e[t]():e["on"+t]&&e["on"+t]()},e.prototype.getStyle=function(e,t){var o=t.replace(/([A-Z])/g,"-$1").toLowerCase();return"function"==typeof window.getComputedStyle?window.getComputedStyle(e).getPropertyValue(o):e.currentStyle[t]},e.prototype.on=function(e,t){return this},e.prototype.off=function(e,t){return this},e.prototype.destroy=function(){},e}();return new s(o,t)}return o})},{}]},{},[1])(1)});